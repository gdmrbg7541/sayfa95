<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- Temel Sayfa Stilleri --- */
        :root {
            --accent-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --bg-light: #f8f9fa;
            --font-arabic: 'Noto Naskh Arabic', 'Tahoma', 'Arial', sans-serif;
        }

        body {
            font-family: var(--font-arabic);
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            font-weight: 400;
        }

        /* --- Ana Etkinlik AlanÄ± (16:9 ve 9:16) --- */
        .activity-container {
            position: relative;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            width: 90vw;
            height: calc(90vw * 9 / 16); /* 16:9 */
            max-height: 90vh;
            max-width: calc(90vh * 16 / 9); /* 16:9 */
        }

        /* --- BaÅŸlÄ±k ve Ä°lerleme Ã‡ubuÄŸu --- */
        .header {
            padding: 15px 25px;
            border-bottom: 1px solid #dee2e6;
            display: grid;
            grid-template-areas: "progress instruction title"; /* SaÄŸ - Orta - Sol (RTL'de) */
            grid-template-columns: 1fr auto 1fr; 
            align-items: center;
            gap: 25px;
        }
        
        .header h2 { /* BaÅŸlÄ±k (Solda) */
            grid-area: title;
            margin: 0;
            font-size: 2rem; /* BÃœYÃœTÃœLDÃœ */
            color: #333;
            font-weight: 700;
            text-align: left;
        }
        
        #instruction-text { /* YÃ¶nerge (Ortada) */
            grid-area: instruction;
            text-align: center;
            font-size: 1.6rem; /* BÃœYÃœTÃœLDÃœ */
            font-weight: 700;
            color: #555;
            background: #f1f3f5;
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        .progress-container { /* Ä°lerleme Ã‡ubuÄŸu (SaÄŸda) */
            grid-area: progress;
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: flex-start;
            width: 200px;
            direction: ltr; 
        }
        #progress-display {
            font-size: 1.5rem; /* BÃœYÃœTÃœLDÃœ */
            font-weight: bold;
            color: var(--accent-color);
            flex-shrink: 0;
        }
        .progress-bar-container {
            flex-grow: 1;
            height: 12px;
            background-color: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        #progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--accent-color);
            transition: width 0.4s ease, background-color 0.4s ease;
        }


        /* --- AsÄ±l Etkinlik AlanÄ± --- */
        .activity-area {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow-y: auto;
        }

        /* --- 1. Soru Tipi: Test (Quiz) --- */
        .quiz-container {
            width: 100%;
        }
        .question {
            font-size: 3.8rem; /* BÃœYÃœTÃœLDÃœ */
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
            color: #212529;
            line-height: 1.5;
        }
        .options {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .option {
            width: 500px;
            max-width: 100%;
            box-sizing: border-box;
            padding: 2px;
            font-size: 2.8rem; /* BÃœYÃœTÃœLDÃœ */
            font-family: var(--font-arabic);
            background-color: var(--bg-light);
            border: 2px solid #ced4da;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        .option:hover {
            border-color: var(--accent-color);
            background-color: #eef5ff;
        }

        /* --- 2. Soru Tipi: SÄ±ralama (Scramble) --- */
        .scramble-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .drop-zone, .drag-zone {
            border: 2px dashed #d0d0d0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            min-height: 120px;
            background: var(--bg-light);
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
        }
        .drop-zone {
            border-style: solid;
            border-color: var(--accent-color);
            font-size: 2.5rem; /* BÃœYÃœTÃœLDÃœ */
            justify-content: center;
        }
        .drag-zone {
             justify-content: center;
             flex-grow: 1;
        }
        .word-item {
            padding: 12px 20px;
            color: white;
            font-size: 2.8rem; /* BÃœYÃœTÃœLDÃœ */
            font-weight: 700;
            margin: 8px;
            border-radius: 8px;
            cursor: grab;
            user-select: none;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .word-item:hover {
            filter: brightness(85%);
        }
        .word-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        
        #check-scramble-btn, #reset-scramble-btn {
            padding: 15px 30px;
            font-size: 2rem; /* BÃœYÃœTÃœLDÃœ */
            font-family: var(--font-arabic);
            font-weight: 700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            margin: 5px;
        }
        #check-scramble-btn {
            background-color: var(--success-color);
            color: white;
        }
        #reset-scramble-btn {
            background-color: var(--danger-color);
            color: white;
        }
        .scramble-controls {
            display: flex;
            justify-content: center;
            margin-top: 15px;
        }

        /* --- Geri Bildirim EkranÄ± (âœ” / âŒ) --- */
        .feedback-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 15rem;
            z-index: 200;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .feedback-overlay.show {
            visibility: visible;
            opacity: 1;
        }
        .feedback-overlay .correct { color: var(--success-color); }
        .feedback-overlay .incorrect { color: var(--danger-color); }
        
        /* --- BitiÅŸ EkranÄ± --- */
        #finish-screen {
            text-align: center;
            font-weight: 700;
            color: var(--accent-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        #finish-screen p {
            font-size: 3.5rem; /* BÃœYÃœTÃœLDÃœ */
            margin: 10px 0;
        }
        
        .score-display {
            display: flex;
            gap: 30px;
            font-size: 2.8rem; /* BÃœYÃœTÃœLDÃœ */
            margin: 20px 0;
            direction: ltr;
        }
        .score-item {
            font-weight: 700;
        }
        .score-correct {
            color: var(--success-color);
        }
        .score-incorrect {
            color: var(--danger-color);
        }

        #replay-button {
            font-size: 4.5rem; /* BÃœYÃœTÃœLDÃœ */
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: transform 0.2s ease, background-color 0.2s ease;
        }
        #replay-button:hover {
            transform: rotate(-90deg);
            background-color: #f0f0f0;
        }

        /* --- Mobil DÃ¼zen (KÃ¼Ã§Ã¼k boyutlar korunuyor) --- */
        @media (orientation: portrait) {
            .activity-container {
                width: 95vw;
                height: calc(95vw * 16 / 9); /* 9:16 */
                max-height: 95vh;
                max-width: calc(95vh * 9 / 16); /* 9:16 */
            }

            /* Mobil: BaÅŸlÄ±k DÃ¼zeni */
            .header {
                grid-template-areas: 
                    "progress title"
                    "instruction instruction";
                grid-template-columns: 1fr 1fr;
                gap: 10px;
                padding: 10px 15px;
            }

            .progress-container {
                width: auto; 
            }

            .header h2 {
                font-size: 1.3rem; 
            }

            #instruction-text {
                font-size: 1.2rem; 
            }

            #progress-display {
                font-size: 1.2rem; 
            }

            /* Mobil: Test ÅÄ±klarÄ± */
            .options {
                gap: 8px; 
            }
            .option {
                font-size: 1.6rem; 
                padding: 10px;
            }
            .question {
                font-size: 2.2rem; 
            }

            /* Mobil CÃ¼mle SÄ±ralama */
            .scramble-container .word-item {
                font-size: 1.8rem; 
                padding: 8px 15px; 
                margin: 5px;
            }
            .scramble-container .drop-zone {
                font-size: 1.8rem; 
                min-height: 80px;  
            }
             .scramble-container .drag-zone {
                min-height: 100px; 
            }
            .scramble-container .scramble-controls {
                margin-top: 5px; 
            }
            .scramble-container #check-scramble-btn,
            .scramble-container #reset-scramble-btn {
                font-size: 1.5rem; 
                padding: 10px 20px;
            }
        }

    </style>
</head>
<body>

    <div class="activity-container">
        
        <div class="header">
            <div class="progress-container">
                <div id="progress-display">0 / 20</div>
                <div class="progress-bar-container">
                    <div id="progress-bar"></div>
                </div>
            </div>
            
            <div id="instruction-text">...</div>

            <h2>Ø£ÙÙƒÙ’ØªÙØ´ÙÙÙ Ù†ÙÙÙ’Ø³ÙŠ</h2>
        </div>

        <div class="activity-area" id="activity-area">
            </div>

        <div class="feedback-overlay" id="feedback-overlay">
            <span id="feedback-icon"></span>
        </div>

    </div>

    <script>
        // --- ETKÄ°NLÄ°K VERÄ°LERÄ° ---
        const activitiesData = [
            { // --- TUR 1: 1. DERS (SaÄŸlÄ±k) ---
                quiz: [
                    { q: "Ù…Ø§ Ø¨ÙÙƒØŸ", o: ["Ø¹ÙÙ†Ø¯ÙŠ ØµÙØ¯Ø§Ø¹", "Ø£ÙØ­ÙØ¨Ù‘Ù ÙƒÙØ±ÙØ© Ø§Ù„Ù‚ÙØ¯ÙÙ…", "Ù‡ÙÙˆØ§ÙŠÙØªÙŠ Ø§Ù„Ù‚ÙØ±Ø§Ø¡ÙØ©", "Ø£ÙØ°Ù’Ù‡ÙØ¨Ù Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙØ¯Ù’Ø±ÙØ³ÙØ©", "Ù‡ÙØ°Ø§ ÙƒÙØªØ§Ø¨"], a: 0 },
                    { q: "Ø¨ÙÙ…Ø§Ø°Ø§ ØªÙØ´Ù’Ø¹ÙØ±ØŸ", o: ["Ø£ÙØ´Ø¹ÙØ±Ù Ø¨ÙØ£ÙÙ„ÙÙ…", "Ù„Ø§ Ø¢ÙƒÙÙ„", "Ù‡ÙÙŠÙ ØªÙÙ„Ø¹ÙØ¨", "Ø£ÙÙ†Ø§ Ù…ÙØ¹ÙÙ„Ù‘ÙÙ…", "Ø¹ÙÙ†Ø¯ÙŠ Ø³ÙÙŠÙ‘Ø§Ø±ÙØ©"], a: 0 },
                    { q: "Ù‡ÙÙ„ Ø¹ÙÙ†Ø¯ÙÙƒÙ Ø¯ÙÙˆØ§Ø¡ØŸ", o: ["Ù†ÙØ¹ÙÙ…ØŒ Ø¹ÙÙ†Ø¯ÙŠ", "Ù†ÙØ¹ÙÙ…ØŒ Ø£ÙÙÙØ¶Ù‘ÙÙ„", "Ù„ÙØ£ÙÙ†Ù‘ÙÙ‡Ù Ù…ÙÙÙŠØ¯", "ÙÙŠ ÙˆÙÙ‚Ù’Øª Ø§Ù„ÙÙØ±Ø§Øº", "Ø£ÙÙ†Ø§ Ù…ÙÙ† ØªÙØ±ÙƒÙÙŠØ§"], a: 0 },
                    { q: "Ø§Ù„Ø·Ù‘ÙØ¨ÙŠØ¨: ... ØªÙØ´Ù’Ø±ÙØ¨ Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ø¨Ø§Ø±ÙØ¯", o: ["Ù„Ø§", "Ø£ÙÙ†Ø§", "Ù‡ÙÙˆÙ", "ÙÙŠ", "Ù…ÙÙ†"], a: 0 },
                    { q: "... ØªÙØ£Ù’Ø®ÙØ°Ù Ø§Ù„Ø¯Ù‘ÙÙˆØ§Ø¡ ÙÙŠ Ø§Ù„ÙŠÙÙˆÙ’Ù…ØŸ", o: ["ÙƒÙÙ… Ù…ÙØ±Ù‘ÙØ©", "Ù‡ÙÙˆÙØ§ÙŠÙØªÙÙŠ Ø§Ù„Ù‚ÙØ±ÙØ§Ø¡ÙØ©", "Ø¹ÙÙ†Ù’Ø¯ÙŠ ØµÙØ¯Ø§Ø¹", "Ù„ÙØ£ÙÙ†Ù‘ÙÙ‡Ø§ Ù…ÙÙÙŠØ¯ÙØ©", "Ø£ÙÙ†Ø§ Ù…ÙØ±ÙŠØ¶"], a: 0 }
                ],
                scramble: [
                    { s: "ÙŠÙØ¬ÙØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’Ùƒ Ø£ÙÙ† ØªÙÙ†Ø§Ù…", w: ["ÙØªÙÙ†Ø§Ù…", "Ø¹ÙÙ„ÙÙŠÙ’Ùƒ", "Ø£ÙÙ†", "ÙŠÙØ¬ÙØ¨"] },
                    { 
                        s: ["Ø£ÙØ´Ø¹ÙØ±Ù Ø¨ÙØ£ÙÙ„ÙÙ… ÙÙŠ Ø±ÙØ£Ù’Ø³ÙŠ", "Ø£ÙØ´Ù’Ø¹ÙØ±Ù ÙÙŠ Ø±ÙØ£Ù’Ø³ÙŠ Ø¨ÙØ£ÙÙ„ÙÙ…"], 
                        w: ["ÙØ±ÙØ£Ù’Ø³ÙŠ", "ÙÙŠ", "Ø¨ÙØ£ÙÙ„ÙÙ…", "Ø£ÙØ´Ø¹ÙØ±"] 
                    },
                    { s: "Ø§Ù„ÙˆÙÙ‚Ø§ÙŠÙØ© Ø®ÙÙŠÙ’Ø± Ù…ÙÙ† Ø§Ù„Ø¹ÙÙ„Ø§Ø¬", w: ["Ø§Ù„Ø¹ÙÙ„Ø§Ø¬", "Ø®ÙÙŠÙ’Ø±", "Ù…ÙÙ†", "Ø§Ù„ÙˆÙÙ‚Ø§ÙŠÙØ©"] }, 
                    { s: "Ø§Ù„Ø·Ù‘ÙÙ‡ÙˆØ± Ø´ÙØ·Ù’Ø± Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†", w: ["Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†", "Ø´ÙØ·Ù’Ø±", "Ø§Ù„Ø·Ù‘ÙÙ‡ÙˆØ±"] },
                    { 
                        s: ["ØªÙÙ†Ø§ÙˆÙÙ„ Ø§Ù„Ù…ÙØ±ÙŠØ¶ Ø§Ù„Ø¯Ù‘ÙÙˆØ§Ø¡", "Ø§Ù„Ù…ÙØ±ÙŠØ¶ ØªÙÙ†Ø§ÙˆÙÙ„ Ø§Ù„Ø¯Ù‘ÙÙˆØ§Ø¡"], 
                        w: ["ÙØ§Ù„Ø¯Ù‘ÙÙˆØ§Ø¡", "Ø§Ù„Ù…ÙØ±ÙŠØ¶", "ØªÙÙ†Ø§ÙˆÙÙ„"] 
                    }
                ]
            },
            { // --- TUR 2: 2. DERS (Hobiler) ---
                quiz: [
                    { q: "Ù…Ø§ Ù‡ÙÙˆØ§ÙŠÙØªÙÙƒØŸ", o: ["Ù‡ÙÙˆØ§ÙŠÙØªÙŠ Ù‚ÙØ±Ø§Ø¡ÙØ© Ø§Ù„ÙƒÙØªÙØ¨", "Ø¹ÙÙ†Ù’Ø¯ÙŠ Ø²ÙÙƒØ§Ù…", "Ø£ÙØ´Ù’Ø¹ÙØ±Ù Ø¨ÙÙ…ÙØºÙ’Øµ", "Ù„ÙØ§ Ø£ÙØ³ØªÙØ·ÙŠØ¹", "Ø´ÙÙØ§ÙƒÙ Ø§Ù„Ù„Ù‡"], a: 0 },
                    { q: "Ù…Ø§Ø°Ø§ ØªÙÙÙ’Ø¹ÙÙ„Ù ÙÙŠ ÙˆÙÙ‚Ù’Øª ÙÙØ±Ø§ØºÙÙƒØŸ", o: ["Ø£ÙØ´Ø§Ù‡ÙØ¯ Ø§Ù„ØªÙ‘ÙÙ„Ù’ÙØ§Ø²", "Ø£ÙØ°Ù’Ù‡ÙØ¨ Ø¥ÙÙ„Ù‰ Ø§Ù„Ù…ÙØ³Ù’ØªÙØ´Ù’ÙÙ‰", "Ø¹ÙÙ†Ù’Ø¯ÙŠ ØµÙØ¯Ø§Ø¹", "Ù‡ÙØ°Ø§ Ø¯ÙÙˆØ§Ø¡", "Ø§Ù„Ø¬ÙÙˆÙ‘ Ø¨Ø§Ø±ÙØ¯"], a: 0 },
                    { q: "Ø£ÙÙŠÙ‘ Ø±ÙÙŠØ§Ø¶ÙØ© ØªÙÙÙØ¶Ù‘ÙÙ„ØŸ", o: ["Ø£ÙÙÙØ¶Ù‘ÙÙ„Ù ÙƒÙØ±ÙØ© Ø§Ù„Ù‚ÙØ¯ÙÙ…", "Ø£ÙÙ†Ø§ Ù…ÙØ±ÙŠØ¶", "Ù‡ÙÙˆÙ ØµÙÙŠÙ’Ø¯ÙÙ„ÙÙŠÙ‘", "Ø¢ÙƒÙÙ„ Ø§Ù„Ø®ÙØ¶Ù’Ø±ÙÙˆØ§Øª", "Ø£ÙØºÙ’Ø³ÙÙ„Ù ÙŠÙØ¯ÙŠ"], a: 0 },
                    { q: "... ØªÙØ­ÙØ¨Ù‘Ù Ø§Ù„Ø±Ù‘ÙÙŠØ§Ø¶ÙØ©ØŸ", o: ["Ù„ÙÙ…Ø§Ø°Ø§", "Ù…Ø§", "Ù…ÙÙ†", "Ø¥ÙÙ„Ù‰", "ÙÙŠ"], a: 0 },
                    { q: "Ø£ÙØ­ÙØ¨Ù‘Ù Ø§Ù„Ø±Ù‘ÙÙŠØ§Ø¶ÙØ© ... Ù…ÙÙÙŠØ¯ÙØ©", o: ["Ù„ÙØ£ÙÙ†Ù‘ÙÙ‡Ø§", "Ø¹ÙÙ„Ù‰", "Ø£ÙÙ…", "ÙÙŠ", "Ù…ÙØ¹"], a: 0 }
                ],
                scramble: [
                    { 
                        s: ["Ø£ÙÙÙØ¶Ù‘ÙÙ„Ù Ø§Ù„Ø´Ù‘Ø§ÙŠ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù‚ÙÙ‡Ù’ÙˆÙØ©", "Ø£ÙÙÙØ¶Ù‘ÙÙ„Ù Ø§Ù„Ù‚ÙÙ‡Ù’ÙˆÙØ© Ø¹ÙÙ„Ù‰ Ø§Ù„Ø´Ù‘Ø§ÙŠ"], 
                        w: ["ÙØ¹ÙÙ„Ù‰", "Ø§Ù„Ø´Ù‘Ø§ÙŠ", "Ø§Ù„Ù‚ÙÙ‡Ù’ÙˆÙØ©", "Ø£ÙÙÙØ¶Ù‘ÙÙ„"] 
                    },
                    { 
                        s: [
                            "Ù…ÙØ§ Ø±ÙØ£ÙŠÙÙƒÙ ÙÙÙŠ ÙƒÙØ±ÙØ© Ø§Ù„Ø³Ù‘ÙÙ„Ù‘Ø©", 
                            "ÙÙÙŠ ÙƒÙØ±ÙØ© Ø§Ù„Ø³Ù‘ÙÙ„Ù‘Ø© Ù…ÙØ§ Ø±ÙØ£ÙŠÙÙƒÙ"
                        ], 
                        w: ["Ø§Ù„Ø³Ù‘ÙÙ„Ù‘ÙØ©", "ÙƒÙØ±ÙØ©", "ÙÙŠ", "Ø±ÙØ£Ù’ÙŠÙÙƒ", "Ù…Ø§"] 
                    },
                    { s: "Ø£ÙÙ†Ø§ Ø£ÙÙ‡ØªÙÙ…Ù‘Ù Ø¨ÙØ§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰", w: ["Ø¨ÙØ§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰", "Ø£ÙÙ‡Ù’ØªÙÙ…Ù‘Ù", "Ø£ÙÙ†Ø§"] },
                    { 
                        s: [
                            "Ø£ÙÙ„Ø¹ÙØ¨ ÙƒÙØ±ÙØ© Ø§Ù„Ù‚ÙØ¯ÙÙ… Ø£ÙØ­ÙŠÙØ§Ù†Ù‹Ø§", 
                            "Ø£ÙØ­ÙŠÙØ§Ù†Ù‹Ø§ Ø£ÙÙ„Ø¹ÙØ¨ ÙƒÙØ±ÙØ© Ø§Ù„Ù‚ÙØ¯ÙÙ…",
                            "Ø£ÙÙ„Ø¹ÙØ¨ Ø£ÙØ­ÙŠÙØ§Ù†Ù‹Ø§ ÙƒÙØ±ÙØ© Ø§Ù„Ù‚ÙØ¯ÙÙ…"
                        ], 
                        w: ["Ø£ÙØ­Ù’ÙŠØ§Ù†Ù‹Ø§", "Ø§Ù„Ù‚ÙØ¯ÙÙ…", "ÙƒÙØ±ÙØ©", "Ø£ÙÙ„Ù’Ø¹ÙØ¨"] 
                    },
                    { s: "Ø§Ù„Ø±Ù‘ÙÙŠØ§Ø¶ÙØ© Ù…ÙÙÙŠØ¯ÙØ© Ù„ÙÙ„Ø¬ÙØ³Ù’Ù…", w: ["Ù„ÙÙ„Ø¬ÙØ³Ù’Ù…", "Ù…ÙÙÙŠØ¯ÙØ©", "Ø§Ù„Ø±Ù‘ÙÙŠØ§Ø¶ÙØ©"] }
                ]
            }
        ];
        
        // VeritabanÄ± TemizliÄŸi (GÃ¶zden kaÃ§an harfler v29)
        activitiesData[0].quiz[2].o[0] = "Ù†ÙØ¹ÙÙ…ØŒ Ø¹ÙÙ†Ø¯ÙŠ";
        activitiesData[0].quiz[2].o[2] = "Ù„ÙØ£ÙÙ†Ù‘ÙÙ‡Ù Ù…ÙÙÙŠØ¯";
        activitiesData[0].quiz[4].o[2] = "Ø¹ÙÙ†Ø¯ÙŠ ØµÙØ¯Ø§Ø¹";
        activitiesData[0].quiz[4].o[3] = "Ù„ÙØ£ÙÙ†Ù‘ÙÙ‡Ø§ Ù…ÙÙÙŠØ¯ÙØ©";
        activitiesData[1].quiz[0].o[1] = "Ø¹ÙÙ†Ø¯ÙŠ Ø²ÙÙƒØ§Ù…";
        activitiesData[1].quiz[1].o[2] = "Ø¹ÙÙ†Ø¯ÙŠ ØµÙØ¯Ø§Ø¹";


        // --- Gerekli Elementler ---
        const activityArea = document.getElementById('activity-area');
        const instructionText = document.getElementById('instruction-text');
        const progressDisplay = document.getElementById('progress-display');
        const progressBar = document.getElementById('progress-bar');
        const feedbackOverlay = document.getElementById('feedback-overlay');
        const feedbackIcon = document.getElementById('feedback-icon');

        // --- Renk Paleti ---
        const colorPalette = [
            '#007bff', '#dc3545', '#28a745', '#ffc107', '#17a2b8', '#6f42c1', '#fd7e14'
        ];

        // --- Ses DeÄŸiÅŸkenleri ---
        let audioCtx = null;

        // --- Durum DeÄŸiÅŸkenleri ---
        let activityQueue = [];
        let currentActivityIndex = 0;
        let grandTotalActivities = 0;
        let scoreCorrect = 0;
        let scoreIncorrect = 0;
        let currentTouchEventItem = null; // Dokunma iÃ§in


        // --- SES FONKSÄ°YONLARI ---
        function initAudioContext() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        function playSound(type) {
            if (!audioCtx) return; 
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.type = 'sine';
            const now = audioCtx.currentTime;

            if (type === 'touch') {
                oscillator.frequency.setValueAtTime(200, now);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.1);
                oscillator.start(now);
                oscillator.stop(now + 0.1);
            } else if (type === 'correct') {
                oscillator.frequency.setValueAtTime(440, now);
                oscillator.frequency.linearRampToValueAtTime(880, now + 0.2);
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.2);
                oscillator.start(now);
                oscillator.stop(now + 0.2);
            } else if (type === 'incorrect') {
                oscillator.frequency.setValueAtTime(300, now);
                oscillator.frequency.linearRampToValueAtTime(150, now + 0.3);
                gainNode.gain.setValueAtTime(0.15, now);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.3);
                oscillator.start(now);
                oscillator.stop(now + 0.3);
            }
        }
        
        document.body.addEventListener('click', initAudioContext, { once: true });


        // --- Fisher-Yates KarÄ±ÅŸtÄ±rma Fonksiyonu ---
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- Aktiviteleri (Test > SÄ±ralama) sÄ±rasÄ±yla hazÄ±rla ---
        function createActivityQueue() {
            const quizActivities = [];
            const scrambleActivities = [];

            activitiesData.forEach(round => {
                round.quiz.forEach(quizData => {
                    quizActivities.push({ type: 'quiz', data: quizData });
                });
                round.scramble.forEach(scrambleData => {
                    scrambleActivities.push({ type: 'scramble', data: scrambleData });
                });
            });
            
            const shuffledQuiz = shuffle(quizActivities);
            const shuffledScramble = shuffle(scrambleActivities);

            activityQueue = [...shuffledQuiz, ...shuffledScramble];
            grandTotalActivities = activityQueue.length;
        }

        // --- ETKÄ°NLÄ°K YÃœKLEYÄ°CÄ° ---
        function loadActivity() {
            activityArea.innerHTML = '';
            updateProgress();
            
            const activity = activityQueue[currentActivityIndex];

            if (activity.type === 'quiz') {
                instructionText.textContent = "Ø§ÙØ®Ù’ØªÙØ± Ø§Ù„Ù’Ø¬ÙÙˆØ§Ø¨ Ø§Ù„ØµÙ‘ÙØ­ÙŠØ­â€«.â€¬";
                buildQuiz(activity.data);
            } else { // activity.type === 'scramble'
                instructionText.textContent = "Ø±ÙØªÙ‘ÙØ¨ Ø§Ù„Ù’ÙƒÙÙ„ÙÙ…Ø§Øª Ù„ÙØªÙÙƒÙ’ÙˆÙŠÙ† Ø¬ÙÙ…Ù’Ù„ÙØ©â€«.â€¬";
                buildScramble(activity.data);
            }
        }

        // --- 1. Test ArayÃ¼zÃ¼nÃ¼ OluÅŸtur ---
        function buildQuiz(data) {
            const quizContainer = document.createElement('div');
            quizContainer.className = 'quiz-container';

            const question = document.createElement('div');
            question.className = 'question';
            question.textContent = data.q;
            quizContainer.appendChild(question);

            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'options';
            
            const optionsToShuffle = data.o.map((optionText, index) => {
                return {
                    text: optionText,
                    isCorrect: (index === data.a)
                };
            });

            const shuffledOptions = shuffle(optionsToShuffle);
            
            shuffledOptions.forEach(option => {
                const optionButton = document.createElement('button');
                optionButton.className = 'option';
                optionButton.textContent = option.text;
                optionButton.onclick = () => {
                    playSound('touch');
                    checkQuizAnswer(option.isCorrect); 
                };
                optionsContainer.appendChild(optionButton);
            });

            quizContainer.appendChild(optionsContainer);
            activityArea.appendChild(quizContainer);
        }

        // --- 2. SÄ±ralama ArayÃ¼zÃ¼nÃ¼ OluÅŸtur ---
        function buildScramble(data) {
            const scrambleContainer = document.createElement('div');
            scrambleContainer.className = 'scramble-container';

            const dropZone = document.createElement('div');
            dropZone.id = 'drop-zone';
            dropZone.className = 'drop-zone';

            const dragZone = document.createElement('div');
            dragZone.id = 'drag-zone';
            dragZone.className = 'drag-zone';

            const shuffledWords = shuffle([...data.w]);
            shuffledWords.forEach((word, index) => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-item';
                wordItem.textContent = word;
                wordItem.id = `word-${index}`;
                wordItem.draggable = true;
                wordItem.style.backgroundColor = colorPalette[index % colorPalette.length];
                dragZone.appendChild(wordItem);
            });

            const controls = document.createElement('div');
            controls.className = 'scramble-controls';
            
            const checkButton = document.createElement('button');
            checkButton.id = 'check-scramble-btn';
            checkButton.textContent = 'âœ” ØªÙØ­ÙÙ‚Ù‘ÙÙ‚';
            checkButton.onclick = () => {
                playSound('touch');
                checkScrambleAnswer(data.s);
            };
            
            const resetButton = document.createElement('button');
            resetButton.id = 'reset-scramble-btn';
            resetButton.textContent = 'ğŸ”„ Ø¥ÙØ¹Ø§Ø¯ÙØ©'; 
            resetButton.onclick = () => {
                playSound('touch');
                loadActivity();
            };

            controls.appendChild(resetButton);
            controls.appendChild(checkButton);
            
            scrambleContainer.appendChild(dropZone);
            scrambleContainer.appendChild(dragZone);
            scrambleContainer.appendChild(controls);
            activityArea.appendChild(scrambleContainer);

            addDragDropListeners();
        }

        // --- CEVAP KONTROLÃœ ---
        function checkQuizAnswer(isCorrect) {
            showFeedback(isCorrect);
            if (isCorrect) {
                scoreCorrect++;
                setTimeout(nextActivity, 1200);
            } else {
                scoreIncorrect++;
            }
        }

        function checkScrambleAnswer(correctAnswers) {
            const dropZone = document.getElementById('drop-zone');
            const words = Array.from(dropZone.children).map(item => item.textContent);
            const userAnswer = words.join(' ');
            
            let isCorrect = false;
            if (Array.isArray(correctAnswers)) {
                isCorrect = correctAnswers.includes(userAnswer);
            } else {
                isCorrect = (userAnswer === correctAnswers);
            }
            
            showFeedback(isCorrect);
            if (isCorrect) {
                scoreCorrect++;
                setTimeout(nextActivity, 1200);
            } else {
                scoreIncorrect++;
            }
        }

        // --- Geri Bildirim (âœ” / âŒ) ---
        function showFeedback(isCorrect) {
            if (isCorrect) {
                feedbackIcon.textContent = 'âœ”';
                feedbackIcon.className = 'correct';
                playSound('correct');
            } else {
                feedbackIcon.textContent = 'âŒ';
                feedbackIcon.className = 'incorrect';
                playSound('incorrect');
            }
            feedbackOverlay.classList.add('show');
            
            if (!isCorrect) {
                setTimeout(() => {
                    feedbackOverlay.classList.remove('show');
                }, 1200);
            }
        }

        // --- Sonraki EtkinliÄŸe GeÃ§iÅŸ ---
        function nextActivity() {
            feedbackOverlay.classList.remove('show');
            currentActivityIndex++; 

            if (currentActivityIndex === grandTotalActivities) {
                showFinishScreen();
            } else {
                loadActivity();
            }
        }

        // --- BitiÅŸ EkranÄ± ---
        function showFinishScreen() {
            activityArea.innerHTML = `
                <div id="finish-screen">
                    <p>Ø£ÙØ­Ù’Ø³ÙÙ†Ù’Øª! Ù„ÙÙ‚ÙØ¯ Ø£ÙÙƒÙ’Ù…ÙÙ„Ù’ØªÙ Ø¬ÙÙ…ÙŠØ¹ Ø§Ù„Ø£ÙÙ†Ù’Ø´ÙØ·ÙØ©â€«.â€¬</p>
                    
                    <div class="score-display">
                        <span class="score-item score-correct">âœ” ${scoreCorrect}</span>
                        <span class="score-item score-incorrect">âŒ ${scoreIncorrect}</span>
                    </div>

                    <button id="replay-button" onclick="restartGame()">ğŸ”„</button>
                </div>
            `;
            instructionText.textContent = "Ø§ÙÙ†Ù’ØªÙÙ‡ÙØª Ø§Ù„Ø£ÙÙ†Ù’Ø´ÙØ·ÙØ©";
            progressDisplay.textContent = "Ø§ÙÙƒÙ’ØªÙÙ…ÙÙ„";
            progressBar.style.width = '100%';
            progressBar.style.backgroundColor = 'var(--success-color)';
        }
        
        // --- Oyunu Yeniden BaÅŸlat Fonksiyonu ---
        function restartGame() {
            playSound('touch');
            
            scoreCorrect = 0;
            scoreIncorrect = 0;
            currentActivityIndex = 0;
            
            progressBar.style.width = '0%';
            progressBar.style.backgroundColor = 'var(--accent-color)';
            
            createActivityQueue(); 
            loadActivity(); 
        }


        // --- Ä°lerleme GÃ¼ncelleme ---
        function updateProgress() {
            if (currentActivityIndex === grandTotalActivities) return; 

            const currentTotal = currentActivityIndex + 1;
            const percentage = (currentActivityIndex / grandTotalActivities) * 100;
            
            progressDisplay.textContent = `${currentTotal} / ${grandTotalActivities}`;
            progressBar.style.width = `${percentage}%`;
        }
        
        // --- SÃ¼rÃ¼kle-BÄ±rak FonksiyonlarÄ± (Basit Sona Ekleme) ---
        function addDragDropListeners() {
            const draggables = document.querySelectorAll('.word-item');
            const containers = [
                document.getElementById('drop-zone'), 
                document.getElementById('drag-zone')
            ];

            // 1. Fare (Mouse) SÃ¼rÃ¼kleme OlaylarÄ±
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', (e) => {
                    draggable.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', draggable.id);
                });
                draggable.addEventListener('dragend', (e) => {
                    draggable.classList.remove('dragging');
                });
            });

            // 2. Fare (Mouse) BÄ±rakma OlaylarÄ±
            containers.forEach(container => {
                container.addEventListener('dragover', (e) => {
                    e.preventDefault(); // BÄ±rakmaya izin ver
                });

                container.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const id = e.dataTransfer.getData('text/plain');
                    const draggable = document.getElementById(id);
                    if (draggable) {
                        // Sadece sona ekle
                        container.appendChild(draggable);
                        draggable.classList.remove('dragging');
                    }
                });
            });
            
            // 3. Dokunmatik Ekran SÃ¼rÃ¼kleme OlaylarÄ±
            draggables.forEach(draggable => {
                draggable.addEventListener('touchstart', (e) => {
                    currentTouchEventItem = e.target;
                    currentTouchEventItem.classList.add('dragging');
                }, { passive: true });
            });
        }
        
        // Global Dokunma OlaylarÄ± (TÃ¼m sayfa iÃ§in)
        function setupGlobalTouchListeners() {
             document.addEventListener('touchmove', (e) => {
                if (!currentTouchEventItem) return;
                e.preventDefault(); 
            }, { passive: false });

            document.addEventListener('touchend', (e) => {
                if (!currentTouchEventItem) return;

                const touch = e.changedTouches[0];
                currentTouchEventItem.style.visibility = 'hidden';
                const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY);
                currentTouchEventItem.style.visibility = 'visible';

                let validDropZone = null;
                if (dropTarget) {
                    if (dropTarget.classList.contains('drop-zone')) {
                        validDropZone = dropTarget;
                    } else if (dropTarget.classList.contains('drag-zone')) {
                        validDropZone = dropTarget;
                    } 
                    else if (dropTarget.closest('.drop-zone')) { 
                        validDropZone = dropTarget.closest('.drop-zone');
                    } else if (dropTarget.closest('.drag-zone')) {
                        validDropZone = dropTarget.closest('.drag-zone');
                    }
                }

                if (validDropZone) {
                     // Sadece sona ekle
                    validDropZone.appendChild(currentTouchEventItem);
                }
                
                currentTouchEventItem.classList.remove('dragging');
                currentTouchEventItem = null;
            });
        }


        // --- BaÅŸlangÄ±Ã§ ---
        document.addEventListener('DOMContentLoaded', () => {
            createActivityQueue();
            loadActivity();
            setupGlobalTouchListeners(); 
        });

    </script>
</body>
</html>